import{p as Q,D as xe,c as gt,i as ce}from"../chunks/DeleteButton.79077667.js";import{S as de,i as _e,s as ge,k as p,a as N,q as te,l as b,m as v,h as d,c as z,r as ne,n as g,b as A,E as _,Q as L,u as et,F as be,a6 as tt,X as ht,Z as Ee,w as se,a7 as oe,J as nt,y as H,z as K,A as R,a5 as mt,a8 as ie,K as lt,L as at,M as rt,g as I,d as B,B as W,T as pt,e as X,v as Ce,f as $e,a9 as Me,R as He,a2 as re,aa as Ke,a4 as Re,ab as st,ac as ot}from"../chunks/index.944dfe2b.js";const bt=!1,vt=async({params:n})=>{const e=await Q.collection("lists").getOne(n.id),l=await Q.collection("list_categories").getFullList(void 0,{filter:`list="${e.id}"`,expand:"categories_gear(category).gear"});return{list:e,categories:l}},Kt=Object.freeze(Object.defineProperty({__proto__:null,load:vt,ssr:bt},Symbol.toStringTag,{value:"Module"}));function yt(n){let e,l,t,a=["Create new",n[1],"..."].join(" ")+"",r,o,i;return{c(){e=p("button"),l=p("i"),t=N(),r=te(a),this.h()},l(s){e=b(s,"BUTTON",{class:!0});var f=v(e);l=b(f,"I",{class:!0}),v(l).forEach(d),t=z(f),r=ne(f,a),f.forEach(d),this.h()},h(){g(l,"class","fa-plus fa-solid"),g(e,"class","text-left text-gray-500 hover:text-secondary-500 transition-colors w-fit")},m(s,f){A(s,e,f),_(e,l),_(e,t),_(e,r),o||(i=L(e,"click",function(){tt(n[0])&&n[0].apply(this,arguments)}),o=!0)},p(s,[f]){n=s,f&2&&a!==(a=["Create new",n[1],"..."].join(" ")+"")&&et(r,a)},i:be,o:be,d(s){s&&d(e),o=!1,i()}}}function wt(n,e,l){let{onClick:t}=e,{entity:a=""}=e;return n.$$set=r=>{"onClick"in r&&l(0,t=r.onClick),"entity"in r&&l(1,a=r.entity)},[t,a]}class it extends de{constructor(e){super(),_e(this,e,wt,yt,ge,{onClick:0,entity:1})}}function kt(n){let e,l,t,a;return{c(){e=p("div"),this.h()},l(r){e=b(r,"DIV",{contenteditable:!0,class:!0,"data-ph":!0}),v(e).forEach(d),this.h()},h(){g(e,"contenteditable","true"),g(e,"class",l="bg-inherit cursor-text focus:bg-gray-50 focus:text-gray-900 focus:p-1 "+n[1]+" svelte-2s1z2f"),g(e,"data-ph",n[2]),n[0]===void 0&&ht(()=>n[4].call(e))},m(r,o){A(r,e,o),n[0]!==void 0&&(e.textContent=n[0]),t||(a=[L(e,"input",n[4]),L(e,"blur",function(){tt(n[3])&&n[3].apply(this,arguments)}),L(e,"keypress",Et)],t=!0)},p(r,[o]){n=r,o&2&&l!==(l="bg-inherit cursor-text focus:bg-gray-50 focus:text-gray-900 focus:p-1 "+n[1]+" svelte-2s1z2f")&&g(e,"class",l),o&4&&g(e,"data-ph",n[2]),o&1&&n[0]!==e.textContent&&(e.textContent=n[0])},i:be,o:be,d(r){r&&d(e),t=!1,Ee(a)}}}function Et(n){let e=n.key,l=n.target;switch(e){case"Escape":l.blur();break;case"Enter":l.blur();break}}function Ct(n,e,l){let{content:t}=e,{classes:a=""}=e,{placeholder:r=""}=e,{handleBlur:o}=e;function i(){t=this.textContent,l(0,t)}return n.$$set=s=>{"content"in s&&l(0,t=s.content),"classes"in s&&l(1,a=s.classes),"placeholder"in s&&l(2,r=s.placeholder),"handleBlur"in s&&l(3,o=s.handleBlur)},[t,a,r,o,i]}class pe extends de{constructor(e){super(),_e(this,e,Ct,kt,ge,{content:0,classes:1,placeholder:2,handleBlur:3})}}function $t(n){let e,l,t,a,r,o,i,s,f,w,$,C,c,k,j,D,U,O,P,h,u,T,G;function le(y){n[7](y)}let F={handleBlur:n[1],placeholder:"Category Name"};n[0].name!==void 0&&(F.content=n[0].name),r=new pe({props:F}),se.push(()=>oe(r,"content",le)),D=new xe({props:{onClick:n[4],name:n[0].name}});const ue=n[6].default,V=nt(ue,n,n[5],null);return h=new it({props:{entity:"item",onClick:n[2]}}),{c(){e=p("table"),l=p("thead"),t=p("tr"),a=p("th"),H(r.$$.fragment),i=N(),s=p("th"),f=te("Weight"),w=N(),$=p("th"),C=te("Qty"),c=N(),k=p("th"),j=p("div"),H(D.$$.fragment),U=N(),O=p("tbody"),V&&V.c(),P=N(),H(h.$$.fragment),this.h()},l(y){e=b(y,"TABLE",{class:!0});var q=v(e);l=b(q,"THEAD",{class:!0});var Z=v(l);t=b(Z,"TR",{class:!0});var M=v(t);a=b(M,"TH",{colspan:!0,class:!0});var x=v(a);K(r.$$.fragment,x),x.forEach(d),i=z(M),s=b(M,"TH",{class:!0});var ee=v(s);f=ne(ee,"Weight"),ee.forEach(d),w=z(M),$=b(M,"TH",{class:!0});var Y=v($);C=ne(Y,"Qty"),Y.forEach(d),c=z(M),k=b(M,"TH",{class:!0});var fe=v(k);j=b(fe,"DIV",{class:!0});var J=v(j);K(D.$$.fragment,J),J.forEach(d),fe.forEach(d),M.forEach(d),Z.forEach(d),U=z(q),O=b(q,"TBODY",{class:!0});var he=v(O);V&&V.l(he),he.forEach(d),q.forEach(d),P=z(y),K(h.$$.fragment,y),this.h()},h(){g(a,"colspan","6"),g(a,"class","text-left text-lg text-primary-500"),g(s,"class","w-1/12"),g($,"class","w-1/12"),g(j,"class","hide svelte-1iz89kj"),g(k,"class","w-10 svelte-1iz89kj"),g(t,"class","svelte-1iz89kj"),g(l,"class","border-b-2 border-surface-500"),g(O,"class","divide-y"),g(e,"class","table-fixed border-b-2 border-surface-500")},m(y,q){A(y,e,q),_(e,l),_(l,t),_(t,a),R(r,a,null),_(t,i),_(t,s),_(s,f),_(t,w),_(t,$),_($,C),_(t,c),_(t,k),_(k,j),R(D,j,null),_(e,U),_(e,O),V&&V.m(O,null),A(y,P,q),R(h,y,q),u=!0,T||(G=L(e,"drop",mt(n[3])),T=!0)},p(y,[q]){const Z={};!o&&q&1&&(o=!0,Z.content=y[0].name,ie(()=>o=!1)),r.$set(Z);const M={};q&1&&(M.name=y[0].name),D.$set(M),V&&V.p&&(!u||q&32)&&lt(V,ue,y,y[5],u?rt(ue,y[5],q,null):at(y[5]),null)},i(y){u||(I(r.$$.fragment,y),I(D.$$.fragment,y),I(V,y),I(h.$$.fragment,y),u=!0)},o(y){B(r.$$.fragment,y),B(D.$$.fragment,y),B(V,y),B(h.$$.fragment,y),u=!1},d(y){y&&d(e),W(r),W(D),V&&V.d(y),y&&d(P),W(h,y),T=!1,G()}}}function Tt(n,e,l){let t;pt(n,gt,c=>l(8,t=c));let{$$slots:a={},$$scope:r}=e,{category:o}=e;async function i(){try{const{name:c}=o;await Q.collection("list_categories").update(o.id,{name:c}),console.log("Category updated")}catch(c){alert("Could not update category"),console.log("Could not update category"),console.error(c)}}async function s(){if(t)try{const c=await Q.collection("gear").create({user:t.id});await Q.collection("categories_gear").create({category:o.id,gear:c.id,quantity:1}),ce(),console.log("Item created")}catch(c){alert("Could not create new item"),console.log("Could not create new item"),console.error(c)}}async function f(c,k){try{await Q.collection("categories_gear").create({category:k,gear:c,quantity:1}),ce(),console.log("Item added to category")}catch(j){alert("Could not add item"),console.log("Could not add item"),console.error(j)}}function w(c){if(!c.dataTransfer)return;const k=c.dataTransfer.getData("text/plain");f(k,o.id)}async function $(){try{await Q.collection("list_categories").delete(o.id),ce(),console.log("category deleted")}catch(c){alert("Could not remove category"),console.log("Could not remove category"),console.error(c)}}function C(c){n.$$.not_equal(o.name,c)&&(o.name=c,l(0,o))}return n.$$set=c=>{"category"in c&&l(0,o=c.category),"$$scope"in c&&l(5,r=c.$$scope)},[o,i,s,w,$,r,a,C]}class It extends de{constructor(e){super(),_e(this,e,Tt,$t,ge,{category:0})}}function We(n){let e,l,t,a,r;const o=n[3].default,i=nt(o,n,n[2],null);return{c(){e=p("div"),l=p("div"),i&&i.c(),this.h()},l(s){e=b(s,"DIV",{class:!0});var f=v(e);l=b(f,"DIV",{class:!0});var w=v(l);i&&i.l(w),w.forEach(d),f.forEach(d),this.h()},h(){g(l,"class","bg-slate-700 text-gray-50 rounded p-4"),g(e,"class","fixed z-50 top-0 left-0 right-0 bottom-0 bg-gray-700/80 flex items-center justify-center")},m(s,f){A(s,e,f),_(e,l),i&&i.m(l,null),t=!0,a||(r=[L(l,"click",Me(n[4])),L(l,"keypress",Me(n[5])),L(e,"click",n[6]),L(e,"keypress",n[1])],a=!0)},p(s,f){i&&i.p&&(!t||f&4)&&lt(i,o,s,s[2],t?rt(o,s[2],f,null):at(s[2]),null)},i(s){t||(I(i,s),t=!0)},o(s){B(i,s),t=!1},d(s){s&&d(e),i&&i.d(s),a=!1,Ee(r)}}}function Dt(n){let e,l,t=n[0]&&We(n);return{c(){t&&t.c(),e=X()},l(a){t&&t.l(a),e=X()},m(a,r){t&&t.m(a,r),A(a,e,r),l=!0},p(a,[r]){a[0]?t?(t.p(a,r),r&1&&I(t,1)):(t=We(a),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(Ce(),B(t,1,1,()=>{t=null}),$e())},i(a){l||(I(t),l=!0)},o(a){B(t),l=!1},d(a){t&&t.d(a),a&&d(e)}}}function Bt(n,e,l){let{$$slots:t={},$$scope:a}=e,{show:r=!1}=e;function o(w){switch(w.key){case"Escape":l(0,r=!1);break}}function i(w){He.call(this,n,w)}function s(w){He.call(this,n,w)}const f=()=>l(0,r=!1);return n.$$set=w=>{"show"in w&&l(0,r=w.show),"$$scope"in w&&l(2,a=w.$$scope)},[r,o,a,t,i,s,f]}class jt extends de{constructor(e){super(),_e(this,e,Bt,Dt,ge,{show:0})}}function qt(n){let e,l,t,a,r,o,i,s,f,w,$;return{c(){e=p("div"),l=p("button"),t=te("◀︎"),a=N(),r=p("span"),o=te(n[0]),i=N(),s=p("button"),f=te("▶︎"),this.h()},l(C){e=b(C,"DIV",{class:!0});var c=v(e);l=b(c,"BUTTON",{});var k=v(l);t=ne(k,"◀︎"),k.forEach(d),a=z(c),r=b(c,"SPAN",{});var j=v(r);o=ne(j,n[0]),j.forEach(d),i=z(c),s=b(c,"BUTTON",{});var D=v(s);f=ne(D,"▶︎"),D.forEach(d),c.forEach(d),this.h()},h(){g(e,"class","flex justify-between w-full px-4")},m(C,c){A(C,e,c),_(e,l),_(l,t),_(e,a),_(e,r),_(r,o),_(e,i),_(e,s),_(s,f),w||($=[L(l,"click",n[3]),L(s,"click",n[4])],w=!0)},p(C,[c]){c&1&&et(o,C[0])},i:be,o:be,d(C){C&&d(e),w=!1,Ee($)}}}function Nt(n,e,l){let{value:t}=e,{onChange:a}=e,{min:r=1}=e;const o=()=>{t<=r||(l(0,t-=1),a())},i=()=>{l(0,t+=1),a()};return n.$$set=s=>{"value"in s&&l(0,t=s.value),"onChange"in s&&l(1,a=s.onChange),"min"in s&&l(2,r=s.min)},[t,a,r,o,i]}class zt extends de{constructor(e){super(),_e(this,e,Nt,qt,ge,{value:0,onChange:1,min:2})}}function Pe(n){let e,l,t,a,r;return{c(){e=p("div"),l=p("a"),t=p("img"),this.h()},l(o){e=b(o,"DIV",{class:!0});var i=v(e);l=b(i,"A",{href:!0});var s=v(l);t=b(s,"IMG",{class:!0,src:!0,alt:!0}),s.forEach(d),i.forEach(d),this.h()},h(){g(t,"class","h-[100px] object-contain"),Ke(t.src,a=n[0].image_url)||g(t,"src",a),g(t,"alt",""),g(l,"href",r=n[0].image_url),g(e,"class","bg-white flex justify-center p-1")},m(o,i){A(o,e,i),_(e,l),_(l,t)},p(o,i){i&1&&!Ke(t.src,a=o[0].image_url)&&g(t,"src",a),i&1&&r!==(r=o[0].image_url)&&g(l,"href",r)},d(o){o&&d(e)}}}function At(n){let e,l,t,a,r,o,i,s,f,w,$,C;return{c(){e=p("h1"),l=te("Add Image URL"),t=N(),a=p("input"),r=N(),o=p("button"),i=te("Save"),s=N(),f=p("button"),w=te("Clear"),this.h()},l(c){e=b(c,"H1",{class:!0});var k=v(e);l=ne(k,"Add Image URL"),k.forEach(d),t=z(c),a=b(c,"INPUT",{class:!0,type:!0,placeholder:!0}),r=z(c),o=b(c,"BUTTON",{class:!0});var j=v(o);i=ne(j,"Save"),j.forEach(d),s=z(c),f=b(c,"BUTTON",{class:!0});var D=v(f);w=ne(D,"Clear"),D.forEach(d),this.h()},h(){g(e,"class","font-bold text-lg pb-2"),g(a,"class","rounded px-2 py-1 text-gray-800"),g(a,"type","text"),g(a,"placeholder","Image URL"),g(o,"class","bg-slate-500 rounded px-2 py-1 ml-2"),g(f,"class","bg-slate-500 rounded px-2 py-1 ml-1")},m(c,k){A(c,e,k),_(e,l),A(c,t,k),A(c,a,k),Re(a,n[0].image_url),A(c,r,k),A(c,o,k),_(o,i),A(c,s,k),A(c,f,k),_(f,w),$||(C=[L(a,"input",n[14]),L(o,"click",n[15]),L(f,"click",n[16])],$=!0)},p(c,k){k&1&&a.value!==c[0].image_url&&Re(a,c[0].image_url)},d(c){c&&d(e),c&&d(t),c&&d(a),c&&d(r),c&&d(o),c&&d(s),c&&d(f),$=!1,Ee(C)}}}function Ut(n){let e,l,t,a,r,o,i,s,f,w,$,C,c,k,j,D,U,O,P,h,u,T,G,le,F,ue,V,y,q,Z,M,x,ee,Y,fe,J,he,ae,Te,Ie,S=n[0].image_url&&Pe(n);function ct(m){n[6](m)}let De={handleBlur:n[3],placeholder:"Name"};n[0].name!==void 0&&(De.content=n[0].name),r=new pe({props:De}),se.push(()=>oe(r,"content",ct));function ut(m){n[7](m)}let Be={handleBlur:n[3],placeholder:"Description"};n[0].description!==void 0&&(Be.content=n[0].description),f=new pe({props:Be}),se.push(()=>oe(f,"content",ut));function ft(m){n[11](m)}let je={handleBlur:n[3]};n[0].weight_g!==void 0&&(je.content=n[0].weight_g),F=new pe({props:je}),se.push(()=>oe(F,"content",ft));function dt(m){n[12](m)}let qe={onChange:n[4]};n[1].quantity!==void 0&&(qe.value=n[1].quantity),q=new zt({props:qe}),se.push(()=>oe(q,"value",dt)),Y=new xe({props:{onClick:n[5],askConfirm:!1}});function _t(m){n[17](m)}let Ne={$$slots:{default:[At]},$$scope:{ctx:n}};return n[2]!==void 0&&(Ne.show=n[2]),J=new jt({props:Ne}),se.push(()=>oe(J,"show",_t)),{c(){e=p("tr"),l=p("td"),S&&S.c(),t=N(),a=p("td"),H(r.$$.fragment),i=N(),s=p("td"),H(f.$$.fragment),$=N(),C=p("td"),c=p("button"),k=p("i"),j=N(),D=p("td"),U=p("button"),O=p("i"),P=N(),h=p("td"),u=p("button"),T=p("i"),G=N(),le=p("td"),H(F.$$.fragment),V=N(),y=p("td"),H(q.$$.fragment),M=N(),x=p("td"),ee=p("div"),H(Y.$$.fragment),fe=N(),H(J.$$.fragment),this.h()},l(m){e=b(m,"TR",{class:!0,draggable:!0});var E=v(e);l=b(E,"TD",{class:!0});var ve=v(l);S&&S.l(ve),ve.forEach(d),t=z(E),a=b(E,"TD",{class:!0});var ye=v(a);K(r.$$.fragment,ye),ye.forEach(d),i=z(E),s=b(E,"TD",{class:!0});var we=v(s);K(f.$$.fragment,we),we.forEach(d),$=z(E),C=b(E,"TD",{class:!0});var ke=v(C);c=b(ke,"BUTTON",{title:!0,class:!0});var me=v(c);k=b(me,"I",{class:!0}),v(k).forEach(d),me.forEach(d),ke.forEach(d),j=z(E),D=b(E,"TD",{class:!0});var ze=v(D);U=b(ze,"BUTTON",{title:!0,class:!0});var Ae=v(U);O=b(Ae,"I",{class:!0}),v(O).forEach(d),Ae.forEach(d),ze.forEach(d),P=z(E),h=b(E,"TD",{class:!0});var Ue=v(h);u=b(Ue,"BUTTON",{title:!0,class:!0});var Oe=v(u);T=b(Oe,"I",{class:!0}),v(T).forEach(d),Oe.forEach(d),Ue.forEach(d),G=z(E),le=b(E,"TD",{class:!0});var Le=v(le);K(F.$$.fragment,Le),Le.forEach(d),V=z(E),y=b(E,"TD",{class:!0});var Ve=v(y);K(q.$$.fragment,Ve),Ve.forEach(d),M=z(E),x=b(E,"TD",{class:!0});var Se=v(x);ee=b(Se,"DIV",{class:!0});var Ge=v(ee);K(Y.$$.fragment,Ge),Ge.forEach(d),Se.forEach(d),E.forEach(d),fe=z(m),K(J.$$.fragment,m),this.h()},h(){g(l,"class","w-[100px]"),g(a,"class","w-1/6 px-2"),g(s,"class","text-gray-500 px-2"),g(k,"class","hover:text-gray-500 transition-colors fa-solid fa-camera"),g(c,"title","Add Image"),g(c,"class","hide svelte-1iz89kj"),g(C,"class","w-8 svelte-1iz89kj"),g(O,"class","hover:text-gray-500 transition-colors fa-solid fa-shirt"),g(U,"title","Consumable Weight"),g(U,"class","svelte-1iz89kj"),re(U,"hide",!n[1].cons_weight),re(U,"text-secondary-500",n[1].cons_weight),g(D,"class","w-8 svelte-1iz89kj"),g(T,"class","hover:text-gray-500 transition-colors fa-solid fa-utensils"),g(u,"title","Worn Weight"),g(u,"class","svelte-1iz89kj"),re(u,"hide",!n[1].worn_weight),re(u,"text-secondary-500",n[1].worn_weight),g(h,"class","w-8 svelte-1iz89kj"),g(le,"class","text-center"),g(y,"class","text-center"),g(ee,"class","hide svelte-1iz89kj"),g(x,"class","text-center svelte-1iz89kj"),g(e,"class","border-y border-surface-500 rounded hover:bg-primary-500/5 svelte-1iz89kj"),g(e,"draggable","true")},m(m,E){A(m,e,E),_(e,l),S&&S.m(l,null),_(e,t),_(e,a),R(r,a,null),_(e,i),_(e,s),R(f,s,null),_(e,$),_(e,C),_(C,c),_(c,k),_(e,j),_(e,D),_(D,U),_(U,O),_(e,P),_(e,h),_(h,u),_(u,T),_(e,G),_(e,le),R(F,le,null),_(e,V),_(e,y),R(q,y,null),_(e,M),_(e,x),_(x,ee),R(Y,ee,null),A(m,fe,E),R(J,m,E),ae=!0,Te||(Ie=[L(c,"click",n[8]),L(U,"click",n[9]),L(u,"click",n[10]),L(e,"dragstart",n[13])],Te=!0)},p(m,[E]){m[0].image_url?S?S.p(m,E):(S=Pe(m),S.c(),S.m(l,null)):S&&(S.d(1),S=null);const ve={};!o&&E&1&&(o=!0,ve.content=m[0].name,ie(()=>o=!1)),r.$set(ve);const ye={};!w&&E&1&&(w=!0,ye.content=m[0].description,ie(()=>w=!1)),f.$set(ye),(!ae||E&2)&&re(U,"hide",!m[1].cons_weight),(!ae||E&2)&&re(U,"text-secondary-500",m[1].cons_weight),(!ae||E&2)&&re(u,"hide",!m[1].worn_weight),(!ae||E&2)&&re(u,"text-secondary-500",m[1].worn_weight);const we={};!ue&&E&1&&(ue=!0,we.content=m[0].weight_g,ie(()=>ue=!1)),F.$set(we);const ke={};!Z&&E&2&&(Z=!0,ke.value=m[1].quantity,ie(()=>Z=!1)),q.$set(ke);const me={};E&262149&&(me.$$scope={dirty:E,ctx:m}),!he&&E&4&&(he=!0,me.show=m[2],ie(()=>he=!1)),J.$set(me)},i(m){ae||(I(r.$$.fragment,m),I(f.$$.fragment,m),I(F.$$.fragment,m),I(q.$$.fragment,m),I(Y.$$.fragment,m),I(J.$$.fragment,m),ae=!0)},o(m){B(r.$$.fragment,m),B(f.$$.fragment,m),B(F.$$.fragment,m),B(q.$$.fragment,m),B(Y.$$.fragment,m),B(J.$$.fragment,m),ae=!1},d(m){m&&d(e),S&&S.d(),W(r),W(f),W(F),W(q),W(Y),m&&d(fe),W(J,m),Te=!1,Ee(Ie)}}}function Ot(n,e,l){let{item:t}=e,{categoryItem:a}=e,r=!1;async function o(){try{await Q.collection("gear").update(t.id,{...t}),ce(),console.log("Gear updated")}catch(u){alert("Could not update gear"),console.log("Could not update gear"),console.error(u)}}async function i(){try{const{quantity:u,cons_weight:T,worn_weight:G}=a;await Q.collection("categories_gear").update(a.id,{quantity:u,cons_weight:T,worn_weight:G}),ce(),console.log("Gear category relation updated")}catch(u){alert("Could not update category gear relation"),console.log("Could not update category gear relation"),console.error(u)}}async function s(){try{await Q.collection("categories_gear").delete(a.id),!t.name&&!t.description&&await Q.collection("gear").delete(t.id),ce(),console.log("gear removed from list")}catch(u){alert("Could not remove item from category"),console.log("Could not remove item from category"),console.error(u)}}function f(u){n.$$.not_equal(t.name,u)&&(t.name=u,l(0,t))}function w(u){n.$$.not_equal(t.description,u)&&(t.description=u,l(0,t))}const $=()=>l(2,r=!0),C=()=>{l(1,a.cons_weight=!a.cons_weight,a),i()},c=()=>{l(1,a.worn_weight=!a.worn_weight,a),i()};function k(u){n.$$.not_equal(t.weight_g,u)&&(t.weight_g=u,l(0,t))}function j(u){n.$$.not_equal(a.quantity,u)&&(a.quantity=u,l(1,a))}const D=u=>{u.dataTransfer&&u.dataTransfer.setData("text/plain",t.id),s()};function U(){t.image_url=this.value,l(0,t)}const O=()=>{o(),l(2,r=!1)},P=()=>l(0,t.image_url=null,t);function h(u){r=u,l(2,r)}return n.$$set=u=>{"item"in u&&l(0,t=u.item),"categoryItem"in u&&l(1,a=u.categoryItem)},[t,a,r,o,i,s,f,w,$,C,c,k,j,D,U,O,P,h]}class Lt extends de{constructor(e){super(),_e(this,e,Ot,Ut,ge,{item:0,categoryItem:1})}}function Qe(n,e,l){const t=n.slice();return t[5]=e[l],t}function Fe(n,e,l){const t=n.slice();return t[8]=e[l],t}function Je(n){let e=[],l=new Map,t,a,r=n[5].expand["categories_gear(category)"];const o=i=>i[8].id;for(let i=0;i<r.length;i+=1){let s=Fe(n,r,i),f=o(s);l.set(f,e[i]=Ye(f,s))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();t=X()},l(i){for(let s=0;s<e.length;s+=1)e[s].l(i);t=X()},m(i,s){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(i,s);A(i,t,s),a=!0},p(i,s){s&1&&(r=i[5].expand["categories_gear(category)"],Ce(),e=st(e,s,o,1,i,r,l,t.parentNode,ot,Ye,t,Fe),$e())},i(i){if(!a){for(let s=0;s<r.length;s+=1)I(e[s]);a=!0}},o(i){for(let s=0;s<e.length;s+=1)B(e[s]);a=!1},d(i){for(let s=0;s<e.length;s+=1)e[s].d(i);i&&d(t)}}}function Xe(n){let e,l;return e=new Lt({props:{item:n[8].expand.gear,categoryItem:n[8]}}),{c(){H(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){const r={};a&1&&(r.item=t[8].expand.gear),a&1&&(r.categoryItem=t[8]),e.$set(r)},i(t){l||(I(e.$$.fragment,t),l=!0)},o(t){B(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function Ye(n,e){let l,t=!Array.isArray(e[8].expand.gear),a,r,o=t&&Xe(e);return{key:n,first:null,c(){l=X(),o&&o.c(),a=X(),this.h()},l(i){l=X(),o&&o.l(i),a=X(),this.h()},h(){this.first=l},m(i,s){A(i,l,s),o&&o.m(i,s),A(i,a,s),r=!0},p(i,s){e=i,s&1&&(t=!Array.isArray(e[8].expand.gear)),t?o?(o.p(e,s),s&1&&I(o,1)):(o=Xe(e),o.c(),I(o,1),o.m(a.parentNode,a)):o&&(Ce(),B(o,1,1,()=>{o=null}),$e())},i(i){r||(I(o),r=!0)},o(i){B(o),r=!1},d(i){i&&d(l),o&&o.d(i),i&&d(a)}}}function Vt(n){let e=n[5].expand&&"categories_gear(category)"in n[5].expand&&Array.isArray(n[5].expand["categories_gear(category)"]),l,t,a=e&&Je(n);return{c(){a&&a.c(),l=X()},l(r){a&&a.l(r),l=X()},m(r,o){a&&a.m(r,o),A(r,l,o),t=!0},p(r,o){o&1&&(e=r[5].expand&&"categories_gear(category)"in r[5].expand&&Array.isArray(r[5].expand["categories_gear(category)"])),e?a?(a.p(r,o),o&1&&I(a,1)):(a=Je(r),a.c(),I(a,1),a.m(l.parentNode,l)):a&&(Ce(),B(a,1,1,()=>{a=null}),$e())},i(r){t||(I(a),t=!0)},o(r){B(a),t=!1},d(r){a&&a.d(r),r&&d(l)}}}function Ze(n,e){let l,t,a;return t=new It({props:{category:e[5],$$slots:{default:[Vt]},$$scope:{ctx:e}}}),{key:n,first:null,c(){l=X(),H(t.$$.fragment),this.h()},l(r){l=X(),K(t.$$.fragment,r),this.h()},h(){this.first=l},m(r,o){A(r,l,o),R(t,r,o),a=!0},p(r,o){e=r;const i={};o&1&&(i.category=e[5]),o&2049&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(r){a||(I(t.$$.fragment,r),a=!0)},o(r){B(t.$$.fragment,r),a=!1},d(r){r&&d(l),W(t,r)}}}function St(n){let e,l,t,a,r,o,i,s,f=[],w=new Map,$,C,c;function k(h){n[3](h)}let j={classes:"text-3xl font-bold",placeholder:"List Name",handleBlur:n[1]};n[0].list.name!==void 0&&(j.content=n[0].list.name),l=new pe({props:j}),se.push(()=>oe(l,"content",k));function D(h){n[4](h)}let U={classes:"",placeholder:"List Description",handleBlur:n[1]};n[0].list.description!==void 0&&(U.content=n[0].list.description),r=new pe({props:U}),se.push(()=>oe(r,"content",D));let O=n[0].categories;const P=h=>h[5].id;for(let h=0;h<O.length;h+=1){let u=Qe(n,O,h),T=P(u);w.set(T,f[h]=Ze(T,u))}return C=new it({props:{entity:"category",onClick:n[2]}}),{c(){e=p("div"),H(l.$$.fragment),a=N(),H(r.$$.fragment),i=N(),s=p("div");for(let h=0;h<f.length;h+=1)f[h].c();$=N(),H(C.$$.fragment),this.h()},l(h){e=b(h,"DIV",{class:!0});var u=v(e);K(l.$$.fragment,u),a=z(u),K(r.$$.fragment,u),i=z(u),s=b(u,"DIV",{class:!0});var T=v(s);for(let G=0;G<f.length;G+=1)f[G].l(T);$=z(T),K(C.$$.fragment,T),T.forEach(d),u.forEach(d),this.h()},h(){g(s,"class","flex flex-col gap-4"),g(e,"class","grid gap-2")},m(h,u){A(h,e,u),R(l,e,null),_(e,a),R(r,e,null),_(e,i),_(e,s);for(let T=0;T<f.length;T+=1)f[T]&&f[T].m(s,null);_(s,$),R(C,s,null),c=!0},p(h,[u]){const T={};!t&&u&1&&(t=!0,T.content=h[0].list.name,ie(()=>t=!1)),l.$set(T);const G={};!o&&u&1&&(o=!0,G.content=h[0].list.description,ie(()=>o=!1)),r.$set(G),u&1&&(O=h[0].categories,Ce(),f=st(f,u,P,1,h,O,w,s,ot,Ze,$,Qe),$e())},i(h){if(!c){I(l.$$.fragment,h),I(r.$$.fragment,h);for(let u=0;u<O.length;u+=1)I(f[u]);I(C.$$.fragment,h),c=!0}},o(h){B(l.$$.fragment,h),B(r.$$.fragment,h);for(let u=0;u<f.length;u+=1)B(f[u]);B(C.$$.fragment,h),c=!1},d(h){h&&d(e),W(l),W(r);for(let u=0;u<f.length;u+=1)f[u].d();W(C)}}}function Gt(n,e,l){let{data:t}=e;console.log(t),console.log(JSON.stringify(t.categories,void 0,2));async function a(){try{await Q.collection("lists").update(t.list.id,t.list),ce(),console.log("list updated")}catch(s){console.error(s)}}async function r(){try{await Q.collection("list_categories").create({list:t.list.id}),ce(),console.log("category created")}catch(s){alert("Could not create new category"),console.log("Could not create new category"),console.error(s)}}function o(s){n.$$.not_equal(t.list.name,s)&&(t.list.name=s,l(0,t))}function i(s){n.$$.not_equal(t.list.description,s)&&(t.list.description=s,l(0,t))}return n.$$set=s=>{"data"in s&&l(0,t=s.data)},[t,a,r,o,i]}class Rt extends de{constructor(e){super(),_e(this,e,Gt,St,ge,{data:0})}}export{Rt as component,Kt as universal};
